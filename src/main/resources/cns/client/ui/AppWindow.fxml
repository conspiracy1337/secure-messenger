<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>

<BorderPane fx:id="rootBorderPane" minHeight="600.0" minWidth="800.0" styleClass="root" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="cns.client.ui.MainController">

    <!-- Top Menu Bar -->
    <top>
        <MenuBar styleClass="menu-bar">
            <Menu text="Contacts">
                <MenuItem fx:id="menuAddContact" text="Add Contact" />
                <MenuItem fx:id="menuManageContacts" text="Delete Contact" />
            </Menu>
            <Menu text="Keys">
                <MenuItem fx:id="menuGenerateKeys" text="Generate New Key Pair" />
                <MenuItem fx:id="menuExportKey" text="Share Public Key" />
            </Menu>
            <Menu text="Help">
                <MenuItem fx:id="menuAbout" text="About" />
            <MenuItem fx:id="menuChangePassword" text="Change Password" />
            <MenuItem fx:id="menuDeleteData" text="Delete Data" />
            </Menu>
        </MenuBar>
    </top>

    <!-- Main Content Area -->
    <center>
        <HBox HBox.hgrow="ALWAYS">

            <!-- Left Panel - Contacts -->
            <VBox maxWidth="480" minWidth="300.0" prefWidth="300.0" styleClass="contacts-panel" VBox.vgrow="ALWAYS">
                <padding>
                    <Insets bottom="0" left="0" right="0" top="20" />
                </padding>

                <!-- Search Box -->
                <HBox alignment="CENTER" prefHeight="64.0" prefWidth="300.0" spacing="0" styleClass="search-container">
                    <padding>
                        <Insets bottom="15" left="15" right="15" top="0" />
                    </padding>
                    <TextField fx:id="searchField" alignment="CENTER" promptText="Search conversations..." styleClass="search-field" HBox.hgrow="ALWAYS" />
                </HBox>

                <!-- Contacts List Area with Left/Right Gaps -->
                <HBox alignment="CENTER" prefWidth="300.0" VBox.vgrow="ALWAYS">
                    <children>
                        <VBox HBox.hgrow="ALWAYS" />
                        <ScrollPane fx:id="contactsScrollPane" fitToWidth="true" hbarPolicy="NEVER" maxWidth="280.0" minWidth="200.0" prefWidth="280.0" vbarPolicy="AS_NEEDED" VBox.vgrow="ALWAYS" />
                        <VBox HBox.hgrow="ALWAYS" />
                    </children>
                </HBox>

                <!-- Bottom Spacer -->
                <!-- Self Profile Section -->
                <HBox fx:id="selfPane" alignment="CENTER_LEFT" minHeight="79.0" prefHeight="115.0" prefWidth="300.0" spacing="12" styleClass="self-profile">
                    <padding>
                        <Insets bottom="15" left="20" right="20" top="15" />
                    </padding>

                    <!-- Profile Picture Circle -->
                    <StackPane>
                        <Circle fill="#1f6feb" radius="28" />
                        <Label fx:id="selfAvatarLabel" style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 20px;" text="?" />
                    </StackPane>

                    <!-- Name and Status Text -->
                    <VBox alignment="CENTER_LEFT" spacing="4" HBox.hgrow="ALWAYS">
                        <Label fx:id="selfStatusLabel" alignment="CENTER" styleClass="self-status" text="Set your status..." />
                    </VBox>
                </HBox>

                <!-- Connection Status Footer -->
                <HBox alignment="CENTER" spacing="12" styleClass="connection-status">
                    <padding>
                        <Insets bottom="15" left="20" right="20" top="15" />
                    </padding>
                    <Circle fx:id="connectionStatusCircle" radius="5" styleClass="status-indicator" />
                    <Label fx:id="connectionStatusLabel" styleClass="status-text" text="Disconnected" />
                </HBox>
            </VBox>

            <!-- Right Panel - Chat Area -->
            <VBox styleClass="chat-panel" HBox.hgrow="ALWAYS">

                <!-- Chat Header -->
                <HBox alignment="CENTER_LEFT" spacing="15" styleClass="chat-header">
                    <padding>
                        <Insets bottom="20" left="25" right="25" top="20" />
                    </padding>

                    <!-- Contact Avatar with Status -->
                    <StackPane>
                        <Circle fill="#1f6feb" radius="22" />
                        <Label fx:id="contactAvatarLabel" style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 18px;" text="?" />
                        <Circle fx:id="contactStatusCircle" radius="7" styleClass="status-indicator-small" translateX="16" translateY="16" />
                    </StackPane>

                    <VBox spacing="4" HBox.hgrow="ALWAYS">
                        <Label fx:id="chatContactName" styleClass="chat-contact-name" text="Select a conversation" />
                        <Label fx:id="chatContactStatus" styleClass="chat-contact-status" text="Choose a contact to start messaging" />
                    </VBox>
                </HBox>
                <HBox HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS">
                    <children>

                        <!-- Messages Display Area -->
                        <ScrollPane fx:id="messagesScrollPane" fitToWidth="true" hbarPolicy="NEVER" styleClass="messages-scroll" HBox.hgrow="ALWAYS">
                            <VBox fx:id="messagesContainer" spacing="12" styleClass="messages-container">
                                <padding>
                                    <Insets bottom="20" left="25" right="25" top="20" />
                                </padding>
                            </VBox>
                        </ScrollPane>
                    </children>
                </HBox>

                <!-- Message Composition Area -->
                <VBox spacing="0" styleClass="compose-panel">

                    <!-- Message Input Area -->
                    <HBox alignment="CENTER" spacing="12" styleClass="input-container">
                        <padding>
                            <Insets bottom="20" left="25" right="25" top="20" />
                        </padding>
                        <VBox alignment="CENTER" spacing="5">
                            <children>
                                <Button fx:id="attachFileButton" styleClass="attach-button" text="ðŸ“Ž">
                                    <tooltip>
                                        <Tooltip text="Attach file" />
                                    </tooltip>
                                </Button>
                                <Button fx:id="emojiButton" styleClass="attach-button" text="ðŸ˜Š">
                                    <tooltip>
                                        <Tooltip text="Emoji" />
                                    </tooltip>
                                </Button>
                            </children>
                        </VBox>

                        <TextArea fx:id="messageInput" maxHeight="120" prefRowCount="1" promptText="Type a message..." styleClass="message-input" wrapText="true" HBox.hgrow="ALWAYS" />

                        <Button fx:id="sendButton" styleClass="send-button" text="âž¤">
                            <tooltip>
                                <Tooltip text="Send message" />
                            </tooltip>
                        </Button>
                    </HBox>

                    <!-- Encryption & Status Bar -->
                    <HBox alignment="CENTER" spacing="20">
                        <padding>
                            <Insets bottom="15" left="25" right="25" top="0" />
                        </padding>
                        <Label fx:id="encryptionStatusLabel" style="-fx-font-size: 11px; -fx-text-fill: #6d7883;" text="ðŸ”’ End-to-end encrypted" />
                    </HBox>
                </VBox>
            </VBox>
        </HBox>
    </center>
</BorderPane>
